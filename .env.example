# DocMind AI Configuration - Environment Variables
# Copy this file to .env and customize for your environment

# ============================================================================
# CORE APPLICATION SETTINGS
# ============================================================================

# Application metadata
DOCMIND_APP_NAME="DocMind AI"
DOCMIND_APP_VERSION="2.0.0"
DOCMIND_DEBUG=false

# Backend configuration (RESTORED: Critical for system initialization)
DOCMIND_LLM_BACKEND=ollama

# Context management
DOCMIND_CONTEXT_BUFFER_SIZE=131072
DOCMIND_ENABLE_CONVERSATION_MEMORY=true

# ============================================================================
# MULTI-AGENT COORDINATION SYSTEM
# ============================================================================

# Enable multi-agent system (5 specialized agents)
DOCMIND_ENABLE_MULTI_AGENT=true

# Agent operation timeouts
DOCMIND_AGENT_DECISION_TIMEOUT=200

# Retry and fallback behavior
DOCMIND_MAX_AGENT_RETRIES=2
DOCMIND_ENABLE_FALLBACK_RAG=true
DOCMIND_MAX_CONCURRENT_AGENTS=3

# Parallel execution optimization
DOCMIND_ENABLE_PARALLEL_TOOL_EXECUTION=true
DOCMIND_MAX_PARALLEL_TOOL_CALLS=3
DOCMIND_TOKEN_REDUCTION_TARGET=0.50

# ============================================================================
# LLM CONFIGURATION (Used by LlamaIndex Settings)
# ============================================================================

# Primary model (FP8 optimized for RTX 4090)
DOCMIND_MODEL_NAME=Qwen/Qwen3-4B-Instruct-2507-FP8

# LLM backend endpoint
DOCMIND_LLM_BASE_URL=http://localhost:11434

# Generation parameters
DOCMIND_TEMPERATURE=0.1
DOCMIND_MAX_TOKENS=2048
DOCMIND_REQUEST_TIMEOUT=120

# Context window (128K for Qwen3 with FP8 optimization)
DOCMIND_CONTEXT_WINDOW_SIZE=131072

# ============================================================================
# EMBEDDING & RETRIEVAL CONFIGURATION
# ============================================================================

# BGE-M3 unified dense/sparse embeddings
DOCMIND_EMBEDDING_MODEL=BAAI/bge-m3

# BGE-M3 specific configuration
DOCMIND_EMBEDDING_DIMENSION=1024
DOCMIND_BGE_M3_MAX_LENGTH=8192
DOCMIND_BGE_M3_BATCH_SIZE_GPU=12
DOCMIND_BGE_M3_BATCH_SIZE_CPU=4

# Document processing optimized for BGE-M3 8K context
DOCMIND_CHUNK_SIZE=1024
DOCMIND_CHUNK_OVERLAP=100

# Retrieval strategy with RRF fusion
DOCMIND_RETRIEVAL_STRATEGY=hybrid
DOCMIND_TOP_K=10
DOCMIND_USE_RERANKING=true
DOCMIND_RERANKING_TOP_K=5
DOCMIND_USE_SPARSE_EMBEDDINGS=true

# RRF Fusion settings
DOCMIND_RRF_FUSION_ALPHA=60
DOCMIND_RRF_K_CONSTANT=60

# Reranking model with performance settings
DOCMIND_RERANKER_MODEL=BAAI/bge-reranker-v2-m3
DOCMIND_RERANKING_BATCH_SIZE=20
DOCMIND_RERANKING_TIMEOUT_MS=100
DOCMIND_RERANKING_USE_GPU=true

# ============================================================================
# DOCUMENT PROCESSING
# ============================================================================

# Document parsing strategy (hi_res for best quality)
DOCMIND_PARSE_STRATEGY=hi_res

# Document size limits
DOCMIND_MAX_DOCUMENT_SIZE_MB=100

# Processing caching
DOCMIND_ENABLE_DOCUMENT_CACHING=true

# Processing batches
DOCMIND_EMBEDDING_BATCH_SIZE=100
DOCMIND_DEFAULT_BATCH_SIZE=20

# ============================================================================
# VECTOR DATABASE (QDRANT)
# ============================================================================

# Vector store configuration
DOCMIND_VECTOR_STORE_TYPE=qdrant
DOCMIND_QDRANT_URL=http://localhost:6333
DOCMIND_QDRANT_COLLECTION=docmind_docs

# ============================================================================
# PERFORMANCE & GPU OPTIMIZATION
# ============================================================================

# GPU acceleration
DOCMIND_ENABLE_GPU_ACCELERATION=true

# Quantization policy (RESTORED: Critical for FP8 optimization)
DOCMIND_QUANT_POLICY=fp8

# Resource limits (tuned for RTX 4090 Laptop 16GB VRAM)
DOCMIND_MAX_MEMORY_GB=4.0
DOCMIND_MAX_VRAM_GB=14.0
DOCMIND_MAX_QUERY_LATENCY_MS=2000

# vLLM Performance Settings (FP8 optimized)
DOCMIND_VLLM_GPU_MEMORY_UTILIZATION=0.95
DOCMIND_VLLM_ATTENTION_BACKEND=FLASHINFER
DOCMIND_VLLM_ENABLE_CHUNKED_PREFILL=true
DOCMIND_VLLM_MAX_NUM_BATCHED_TOKENS=8192
DOCMIND_VLLM_MAX_NUM_SEQS=16

# Additional vLLM environment variables
VLLM_ATTENTION_BACKEND=FLASHINFER
VLLM_KV_CACHE_DTYPE=fp8_e5m2
VLLM_GPU_MEMORY_UTILIZATION=0.95
VLLM_USE_CUDNN_PREFILL=1
VLLM_CALCULATE_KV_SCALES=true
VLLM_ENABLE_CHUNKED_PREFILL=true

# RESTORED: Complete vLLM server configuration for optimal GPU performance
VLLM_TORCH_BACKEND=cu128
VLLM_MODEL=Qwen/Qwen3-4B-Instruct-2507-FP8
VLLM_TENSOR_PARALLEL_SIZE=1
VLLM_MAX_MODEL_LEN=131072
VLLM_ENABLE_PREFIX_CACHING=true
VLLM_USE_V2_BLOCK_MANAGER=true
VLLM_QUANTIZATION=fp8
VLLM_MAX_NUM_SEQS=256

# RESTORED: PyTorch and CUDA configuration
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512
TOKENIZERS_PARALLELISM=false

# RESTORED: CUDA environment variables (critical for GPU detection)
CUDA_VISIBLE_DEVICES=0
NVIDIA_VISIBLE_DEVICES=all
CUDA_HOME=/usr/local/cuda

# ============================================================================
# FILE SYSTEM & PERSISTENCE
# ============================================================================

# Data directories
DOCMIND_DATA_DIR=./data
DOCMIND_CACHE_DIR=./cache

# Database
DOCMIND_SQLITE_DB_PATH=./data/docmind.db
DOCMIND_ENABLE_WAL_MODE=true

# Logging
DOCMIND_LOG_FILE=./logs/docmind.log
DOCMIND_LOG_LEVEL=INFO
DOCMIND_ENABLE_PERFORMANCE_LOGGING=true

# ============================================================================
# USER INTERFACE
# ============================================================================

# Streamlit configuration
DOCMIND_STREAMLIT_PORT=8501
DOCMIND_ENABLE_UI_DARK_MODE=true

# ============================================================================
# ADVANCED FEATURES (EXPERIMENTAL)
# ============================================================================

# GraphRAG for relationship queries
DOCMIND_ENABLE_GRAPHRAG=false
DOCMIND_GRAPHRAG_MAX_TRIPLETS=1000
DOCMIND_GRAPHRAG_CHUNK_SIZE=1024

# Multimodal document processing
DOCMIND_ENABLE_MULTIMODAL=false

# DSPy prompt optimization
DOCMIND_ENABLE_DSPY_OPTIMIZATION=true
DOCMIND_DSPY_OPTIMIZATION_SAMPLES=20
DOCMIND_DSPY_MAX_RETRIES=3
DOCMIND_DSPY_TEMPERATURE=0.1

# Analysis modes configuration
DOCMIND_ANALYSIS_MODES=detailed,summary,comparison

# ============================================================================
# DEVELOPMENT & DEBUGGING
# ============================================================================

# Additional logging for development
# DOCMIND_LOG_LEVEL=DEBUG

# Reduce timeouts for faster development cycles
# DOCMIND_AGENT_DECISION_TIMEOUT=100
# DOCMIND_REQUEST_TIMEOUT=30

# Use smaller context for faster processing during development
# DOCMIND_CONTEXT_WINDOW_SIZE=8192
# DOCMIND_CHUNK_SIZE=256

# ============================================================================
# PRODUCTION OPTIMIZATIONS
# ============================================================================

# For production deployment, consider:
# DOCMIND_MAX_CONCURRENT_AGENTS=5
# DOCMIND_EMBEDDING_BATCH_SIZE=200
# DOCMIND_VLLM_GPU_MEMORY_UTILIZATION=0.90
# DOCMIND_ENABLE_PERFORMANCE_LOGGING=true
# DOCMIND_LOG_LEVEL=WARNING
