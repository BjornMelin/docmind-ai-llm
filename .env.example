## DocMind AI .env (copy from this file)
## Nested mapping: DOCMIND_SECTION__FIELD -> settings.section.field

# ============================================================================
# CORE APPLICATION SETTINGS (FLAT FORMAT - TOP LEVEL)
# ============================================================================


# Backend configuration (flat - maps to settings.llm_backend)
DOCMIND_LLM_BACKEND=ollama

## Agents
DOCMIND_AGENTS__ENABLE_MULTI_AGENT=true
DOCMIND_AGENTS__DECISION_TIMEOUT=200
DOCMIND_AGENTS__MAX_RETRIES=2
DOCMIND_AGENTS__ENABLE_FALLBACK_RAG=true
DOCMIND_AGENTS__MAX_CONCURRENT_AGENTS=3
DOCMIND_AGENTS__ENABLE_PARALLEL_TOOL_EXECUTION=true
DOCMIND_AGENTS__CONTEXT_BUFFER_SIZE=131072

## LLM
DOCMIND_VLLM__MODEL=Qwen/Qwen3-4B-Instruct-2507-FP8
DOCMIND_OLLAMA_BASE_URL=http://localhost:11434
DOCMIND_LMSTUDIO_BASE_URL=http://localhost:1234/v1
DOCMIND_VLLM__VLLM_BASE_URL=http://localhost:8000
DOCMIND_VLLM__TEMPERATURE=0.1
DOCMIND_VLLM__MAX_TOKENS=2048
DOCMIND_VLLM__CONTEXT_WINDOW=131072
DOCMIND_UI__REQUEST_TIMEOUT_SECONDS=120
DOCMIND_UI__STREAMLIT_PORT=8501
DOCMIND_UI__ENABLE_DARK_MODE=true
DOCMIND_UI__RESPONSE_STREAMING=true
DOCMIND_UI__MAX_HISTORY_ITEMS=100
DOCMIND_OPENAI__BASE_URL=http://localhost:1234/v1
DOCMIND_OPENAI__API_KEY=not-needed
DOCMIND_LLM_REQUEST_TIMEOUT_SECONDS=120
DOCMIND_LLM_STREAMING_ENABLED=true

## Embeddings
DOCMIND_EMBEDDING__MODEL_NAME=BAAI/bge-m3
DOCMIND_EMBEDDING__DIMENSION=1024
DOCMIND_EMBEDDING__MAX_LENGTH=8192
DOCMIND_EMBEDDING__BATCH_SIZE_TEXT_GPU=12
DOCMIND_EMBEDDING__BATCH_SIZE_TEXT_CPU=4

## Processing
DOCMIND_PROCESSING__CHUNK_SIZE=1024
DOCMIND_PROCESSING__CHUNK_OVERLAP=100
DOCMIND_PROCESSING__NEW_AFTER_N_CHARS=1200
DOCMIND_PROCESSING__COMBINE_TEXT_UNDER_N_CHARS=500
DOCMIND_PROCESSING__MULTIPAGE_SECTIONS=true

## Retrieval
DOCMIND_RETRIEVAL__STRATEGY=hybrid
DOCMIND_RETRIEVAL__TOP_K=10
DOCMIND_RETRIEVAL__USE_RERANKING=true
DOCMIND_RETRIEVAL__RERANKING_TOP_K=5
DOCMIND_RETRIEVAL__USE_SPARSE_EMBEDDINGS=true
DOCMIND_RETRIEVAL__ROUTER=auto
DOCMIND_RETRIEVAL__ENABLE_SERVER_HYBRID=true
DOCMIND_RETRIEVAL__HIERARCHY_ENABLED=true
DOCMIND_RETRIEVAL__GRAPH_ENABLED=false
## Server-side fusion (Qdrant Query API)
DOCMIND_RETRIEVAL__FUSION_MODE=rrf   # or dbsf when supported
DOCMIND_RETRIEVAL__FUSED_TOP_K=60
DOCMIND_RETRIEVAL__RRF_K=60
## Reranking timeout budgets (milliseconds)
DOCMIND_RETRIEVAL__TEXT_RERANK_TIMEOUT_MS=250
DOCMIND_RETRIEVAL__SIGLIP_TIMEOUT_MS=150
DOCMIND_RETRIEVAL__COLPALI_TIMEOUT_MS=400
DOCMIND_RETRIEVAL__TOTAL_RERANK_BUDGET_MS=800
DOCMIND_RETRIEVAL__RERANKER_NORMALIZE_SCORES=true
DOCMIND_RETRIEVAL__RERANKER_MODE=auto
DOCMIND_RETRIEVAL__RERANKER_MODEL=BAAI/bge-reranker-v2-m3
DOCMIND_RETRIEVAL__ENABLE_COLPALI=false
DOCMIND_RETRIEVAL__SIGLIP_BATCH_SIZE=8
DOCMIND_RETRIEVAL__SIGLIP_PRUNE_M=64

## Cache
DOCMIND_CACHE__ENABLE_DOCUMENT_CACHING=true
DOCMIND_CACHE__TTL_SECONDS=3600
DOCMIND_CACHE__MAX_SIZE_MB=1000
DOCMIND_CACHE__DIR=./cache
DOCMIND_CACHE__FILENAME=docmind.duckdb

## Database (Qdrant + SQLite)
DOCMIND_DATABASE__SQLITE_DB_PATH=./data/docmind.db
DOCMIND_DATABASE__ENABLE_WAL_MODE=true
DOCMIND_DATABASE__QDRANT_URL=http://localhost:6333
DOCMIND_DATABASE__QDRANT_COLLECTION=docmind_docs
DOCMIND_DATABASE__QDRANT_TIMEOUT=60

# RBAC filter owner id (optional)
DOCMIND_OWNER_ID=

## Monitoring & performance
DOCMIND_ENABLE_GPU_ACCELERATION=true
DOCMIND_MONITORING__MAX_MEMORY_GB=4.0
DOCMIND_MONITORING__MAX_VRAM_GB=14.0
DOCMIND_MONITORING__MAX_QUERY_LATENCY_MS=2000
DOCMIND_MONITORING__ENABLE_PERFORMANCE_LOGGING=true
DOCMIND_MONITORING__DEFAULT_BATCH_SIZE=20
## Hashing / canonicalization
DOCMIND_HASHING__HMAC_SECRET=change-me-please-to-a-unique-32-byte-secret-1234
## Security
DOCMIND_SECURITY__ALLOW_REMOTE_ENDPOINTS=false
# Add entries as URLs or hostnames; hostnames are matched case-insensitively.
DOCMIND_SECURITY__ENDPOINT_ALLOWLIST=["http://localhost","https://localhost","http://127.0.0.1","https://127.0.0.1"]
DOCMIND_SECURITY__TRUST_REMOTE_CODE=false

## vLLM server
DOCMIND_VLLM__GPU_MEMORY_UTILIZATION=0.85
DOCMIND_VLLM__ATTENTION_BACKEND=FLASHINFER
DOCMIND_VLLM__ENABLE_CHUNKED_PREFILL=true
DOCMIND_VLLM__MAX_NUM_BATCHED_TOKENS=8192
DOCMIND_VLLM__MAX_NUM_SEQS=16
# Raw VLLM_* keys removed in favor of DOCMIND_VLLM__*
# Optional advanced server flags (uncomment if needed)

## Semantic cache (ADR-035) [planned]
DOCMIND_SEMANTIC_CACHE__ENABLED=false
DOCMIND_SEMANTIC_CACHE__PROVIDER=gptcache
DOCMIND_SEMANTIC_CACHE__SCORE_THRESHOLD=0.85
DOCMIND_SEMANTIC_CACHE__TTL_SECONDS=1209600
DOCMIND_SEMANTIC_CACHE__TOP_K=5
DOCMIND_SEMANTIC_CACHE__MAX_RESPONSE_BYTES=24000
DOCMIND_SEMANTIC_CACHE__NAMESPACE=default

## Chat memory & Analysis modes [planned]
DOCMIND_CHAT__SQLITE_PATH=./data/docmind.db
DOCMIND_ANALYSIS__MODE=auto
DOCMIND_ANALYSIS__MAX_WORKERS=4

## GraphRAG [planned]
# GraphRAG global feature flag (router/UI gate)
DOCMIND_ENABLE_GRAPHRAG=false
# GraphRAG nested configuration (both flags must be true to enable)
DOCMIND_GRAPHRAG_CFG__CHUNK_SIZE=1024
DOCMIND_GRAPHRAG_CFG__ENABLED=false
DOCMIND_GRAPHRAG_CFG__ENTITY_RESOLUTION=fuzzy
DOCMIND_GRAPHRAG_CFG__MAX_HOPS=2
DOCMIND_GRAPHRAG_CFG__MAX_TRIPLETS=1000
DOCMIND_GRAPHRAG_CFG__RELATIONSHIP_EXTRACTION=false
# DEPRECATED: Legacy flat DOCMIND_GRAPHRAG__ENABLED,
# DOCMIND_GRAPHRAG__RELATIONSHIP_EXTRACTION, DOCMIND_GRAPHRAG__ENTITY_RESOLUTION,
# DOCMIND_GRAPHRAG__MAX_HOPS, DOCMIND_GRAPHRAG__MAX_TRIPLETS,
# DOCMIND_GRAPHRAG__CHUNK_SIZE are no longer used.
# Migration: map DOCMIND_GRAPHRAG__ENABLED -> DOCMIND_GRAPHRAG_CFG__ENABLED and
# keep DOCMIND_ENABLE_GRAPHRAG as the global feature gate.

## DSPy optimization [planned]
DOCMIND_ENABLE_DSPY_OPTIMIZATION=false
DOCMIND_DSPY_OPTIMIZATION_ITERATIONS=10
DOCMIND_DSPY_OPTIMIZATION_SAMPLES=20
DOCMIND_DSPY_MAX_RETRIES=3
DOCMIND_DSPY_TEMPERATURE=0.1
DOCMIND_DSPY_METRIC_THRESHOLD=0.8
DOCMIND_ENABLE_DSPY_BOOTSTRAPPING=true


# PyTorch and CUDA configuration
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512
TOKENIZERS_PARALLELISM=false
CUDA_VISIBLE_DEVICES=0
NVIDIA_VISIBLE_DEVICES=all
CUDA_HOME=/usr/local/cuda

# Offline operation (pre-download models to use)
HF_HUB_OFFLINE=1
TRANSFORMERS_OFFLINE=1

# Observability / OpenTelemetry (SPEC-012)
DOCMIND_OBSERVABILITY__ENABLED=false
# When enabled, configure protocol and endpoint as needed:
# DOCMIND_OBSERVABILITY__PROTOCOL=http/protobuf
# DOCMIND_OBSERVABILITY__ENDPOINT=http://localhost:4318

# Optional AES-GCM key for encrypting page images (.enc); base64-encoded 32B key
DOCMIND_IMG_AES_KEY_BASE64=
DOCMIND_IMG_KID=local-key-1
DOCMIND_IMG_DELETE_PLAINTEXT=false

## FILE SYSTEM & PERSISTENCE (FLAT FORMAT - TOP LEVEL)
## Data directories (flat - maps to settings.data_dir, settings.cache_dir)
DOCMIND_DATA_DIR=./data
DOCMIND_CACHE_DIR=./cache

# Logging (flat - maps to settings.log_file, settings.log_level, settings.enable_performance_logging)
DOCMIND_LOG_FILE=./logs/docmind.log
DOCMIND_LOG_LEVEL=INFO
